import{e as s,d as R,n as E,b as D,p as M,c as b,o,w as y,m as x,S as m,x as N,j as f,y as V,g as l,f as c,F as S,h as I,t as p,z as j,B as F}from"./index-DtXg1mwU.js";import{i as J}from"./boolean-ByBdOQql.js";import{w as O}from"./defaults-CMtlFFSf.js";import{_ as U}from"./Table-D3KqVi0W.js";class h extends Error{}h.prototype.name="InvalidTokenError";function z(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,n)=>{let a=n.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}function G(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return z(e)}catch{return atob(e)}}function v(t,e){if(typeof t!="string")throw new h("Invalid token specified: must be a string");e||(e={});const n=e.header===!0?0:1,a=t.split(".")[n];if(typeof a!="string")throw new h(`Invalid token specified: missing part #${n+1}`);let i;try{i=G(a)}catch(r){throw new h(`Invalid token specified: invalid base64 for part #${n+1} (${r.message})`)}try{return JSON.parse(i)}catch(r){throw new h(`Invalid token specified: invalid json for part #${n+1} (${r.message})`)}}const L={HS256:"HMAC using SHA-256",HS384:"HMAC using SHA-384",HS512:"HMAC using SHA-512",RS256:"RSASSA-PKCS1-v1_5 using SHA-256",RS384:"RSASSA-PKCS1-v1_5 using SHA-384",RS512:"RSASSA-PKCS1-v1_5 using SHA-512",ES256:"ECDSA using P-256 and SHA-256",ES384:"ECDSA using P-384 and SHA-384",ES512:"ECDSA using P-521 and SHA-512",PS256:"RSASSA-PSS using SHA-256 and MGF1 with SHA-256",PS384:"RSASSA-PSS using SHA-384 and MGF1 with SHA-384",PS512:"RSASSA-PSS using SHA-512 and MGF1 with SHA-512",none:"No digital signature or MAC performed"},K={typ:"Type",alg:"Algorithm",iss:"Issuer",sub:"Subject",aud:"Audience",exp:"Expiration Time",nbf:"Not Before",iat:"Issued At",jti:"JWT ID",name:"Full name",given_name:"Given name(s) or first name(s)",family_name:"Surname(s) or last name(s)",middle_name:"Middle name(s)",nickname:"Casual name",preferred_username:"Shorthand name by which the End-User wishes to be referred to",profile:"Profile page URL",picture:"Profile picture URL",website:"Web page or blog URL",email:"Preferred e-mail address",email_verified:"True if the e-mail address has been verified; otherwise false",gender:"Gender",birthdate:"Birthday",zoneinfo:"Time zone",locale:"Locale",phone_number:"Preferred telephone number",phone_number_verified:"True if the phone number has been verified; otherwise false",address:"Preferred postal address",updated_at:"Time the information was last updated",azp:"Authorized party - the party to which the ID Token was issued",nonce:"Value used to associate a Client session with an ID Token",auth_time:"Time when the authentication occurred",at_hash:"Access Token hash value",c_hash:"Code hash value",acr:"Authentication Context Class Reference",amr:"Authentication Methods References",sub_jwk:"Public key used to check the signature of an ID Token",cnf:"Confirmation",sip_from_tag:"SIP From tag header field parameter value",sip_date:"SIP Date header field value",sip_callid:"SIP Call-Id header field value",sip_cseq_num:"SIP CSeq numeric header field parameter value",sip_via_branch:"SIP Via branch header field parameter value",orig:"Originating Identity String",dest:"Destination Identity String",mky:"Media Key Fingerprint String",events:"Security Events",toe:"Time of Event",txn:"Transaction Identifier",rph:"Resource Priority Header Authorization",sid:"Session ID",vot:"Vector of Trust value",vtm:"Vector of Trust trustmark URL",attest:"Attestation level as defined in SHAKEN framework",origid:"Originating Identifier as defined in SHAKEN framework",act:"Actor",scope:"Scope Values",client_id:"Client Identifier",may_act:"Authorized Actor - the party that is authorized to become the actor",jcard:"jCard data",at_use_nbr:"Number of API requests for which the access token can be used",div:"Diverted Target of a Call",opt:"Original PASSporT (in Full Form)",vc:"Verifiable Credential as specified in the W3C Recommendation",vp:"Verifiable Presentation as specified in the W3C Recommendation",sph:"SIP Priority header field",ace_profile:"ACE profile a token is supposed to be used with.",cnonce:"Client nonce",exi:"Expires in",roles:"Roles",groups:"Groups",entitlements:"Entitlements",token_introspection:"Token introspection response"};function k({jwt:t}){const e=v(t,{header:!0}),n=v(t),a=s.map(e,(r,d)=>C({claim:d,value:r})),i=s.map(n,(r,d)=>C({claim:d,value:r}));return{header:a,payload:i}}function C({claim:t,value:e}){const n=K[t],a=s.isPlainObject(e)||s.isArray(e)?JSON.stringify(e,null,3):s.toString(e),i=W({claim:t,value:e});return{value:a,friendlyValue:i,claim:t,claimDescription:n}}function W({claim:t,value:e}){if(["exp","nbf","iat"].includes(t))return B(e);if(t==="alg"&&s.isString(e))return L[e]}function B(t){if(s.isNil(t))return;const e=new Date(Number(t)*1e3);return`${e.toLocaleDateString()} ${e.toLocaleTimeString()}`}const $={colspan:"2",class:"table-header"},q={class:"claims",style:{"vertical-align":"top"}},Q={"font-bold":""},X={key:0,"ml-2":"","op-70":""},Y={style:{"word-wrap":"break-word","word-break":"break-all"}},Z={key:0,"ml-2":"","op-70":""},ee=R({__name:"jwt-parser",setup(t){const e=E("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"),n=D(()=>O(()=>k({jwt:e.value}),{header:[],payload:[]})),a=[{key:"header",title:"Header"},{key:"payload",title:"Payload"}],i=M({source:e,rules:[{validator:r=>r.length>0&&J(()=>k({jwt:e.value})),message:"Invalid JWT"}]});return(r,d)=>{const P=N,T=U,H=j;return o(),b(H,null,{default:y(()=>[x(P,{value:f(e),"onUpdate:value":d[0]||(d[0]=u=>V(e)?e.value=u:null),label:"JWT to decode",validation:f(i),placeholder:"Put your token here...",rows:"5",multiline:"","raw-text":"",autofocus:"","mb-3":""},null,8,["value","validation"]),f(i).isValid?(o(),b(T,{key:0},{default:y(()=>[l("tbody",null,[(o(),c(S,null,I(a,u=>(o(),c(S,{key:u.key},[l("th",$,p(u.title),1),(o(!0),c(S,null,I(f(n)[u.key],({claim:_,claimDescription:g,friendlyValue:w,value:A})=>(o(),c("tr",{key:_+A},[l("td",q,[l("span",Q,p(_),1),g?(o(),c("span",X," ("+p(g)+") ",1)):m("",!0)]),l("td",Y,[l("span",null,p(A),1),w?(o(),c("span",Z," ("+p(w)+") ",1)):m("",!0)])]))),128))],64))),64))])]),_:1})):m("",!0)]),_:1})}}}),ie=F(ee,[["__scopeId","data-v-70e80d9e"]]);export{ie as default};
